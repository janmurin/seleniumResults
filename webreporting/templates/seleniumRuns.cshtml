@using SeleniumResults.Models
@model SeleniumResults.webreporting.ViewModels.SeleniumRunsViewModel

@{
    Layout = "_Layout.cshtml";
}

<!-- Page Heading -->
<h1 class="h3 mb-2 text-gray-800">Selenium test runs</h1>

<div class="table-responsive bg-white">
    <table class="table table-bordered" id="seleniumRunsDatatable" width="100%" cellspacing="0">
        <thead>
            <tr>
                <th>Time</th>
                <th>File</th>
                <th>Application</th>
                <th>Sel1/Sel2</th>
                <th>Result</th>
                <th>BuildNumber</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <th>Time</th>
                <th>File</th>
                <th>Application</th>
                <th>Sel1/Sel2</th>
                <th>Result</th>
                <th>BuildNumber</th>
            </tr>
        </tfoot>
        <tbody>
        @foreach (var sr in Model.TestRuns)
        {
            <tr>
                <td>@($"{sr.TestRunMetaData.LastRun:yyyy-MM-dd HH:mm:ss}")</td>
                <td>
                    <a href="data/@sr.TestRunMetaData.OriginalFileName" target="_blank">@sr.TestRunMetaData.OriginalFileName</a>
                </td>
                <td>@sr.TestRunMetaData.FlytApplicationType</td>
                <td>
                    @if (sr.IsSel1)
                    {
                        <span class="badge badge-light">Selenium 1</span>
                    }
                    @if (sr.IsSel2)
                    {
                        <span class="badge badge-info">Selenium 2</span>
                    }
                </td>
                <td>
                    @if (sr.IsPassed)
                    {
                        <span class="badge badge-success">Passed</span> <span style="color:red;">@sr.FailedCount</span><span>/@sr.TotalCount</span>
                    }
                    else if (sr.HasTooManyFailures)
                    {
                        <span class="badge badge-dark">Too many errors</span> <span style="color:red;">@sr.FailedCount</span><span>/@sr.TotalCount</span>
                    }
                    else
                    {
                        <span class="badge badge-danger">Failed</span> <span style="color:red;">@sr.FailedCount</span><span>/@sr.TotalCount</span>
                    }
                </td>
                <td>@sr.TestRunMetaData.BuildNumber</td>
            </tr>
        }
        </tbody>
    </table>
</div>

@section scripts {
    <script>
    $(document).ready(function () {
        $('#seleniumRunsDatatable').DataTable({
            "order": [[0, "desc"]],
            "pageLength": 25
        });
    });
    </script>
}